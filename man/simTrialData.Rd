% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simTrialData.R
\name{simTrialData}
\alias{simTrialData}
\title{Simulate clinical trial data for multiple groups}
\usage{
simTrialData(
  nsim = 1000,
  n,
  a.dist = "pieceunif",
  a.time,
  intensity = NULL,
  proportion = NULL,
  rate = NULL,
  continuous = FALSE,
  e.time,
  e.hazard,
  d.time = NULL,
  d.hazard = NULL,
  seed = NULL
)
}
\arguments{
\item{nsim}{A positive integer specifying the number of simulation iterations. Default is 1000.}

\item{n}{A named list where each element corresponds to a group with sample sizes.
Example: list(control = 100, treatment = 100) for two groups.}

\item{a.dist}{A character string specifying the accrual distribution. Must be one of
"pieceunif" (piecewise uniform) or "piecepois" (piecewise Poisson). Default is "pieceunif".}

\item{a.time}{A numeric vector of time points defining the accrual intervals.
For pieceunif: length should be one more than length of intensity/proportion.
For piecepois: length should be equal to length of rate.
Time points must be in increasing order.}

\item{intensity}{A numeric vector of accrual intensities (rate per time unit) for each interval
when using piecewise uniform distribution. Cannot be used with proportion. Default is NULL.}

\item{proportion}{A numeric vector of accrual proportions for each interval that sum to 1
when using piecewise uniform distribution. Cannot be used with intensity. Default is NULL.}

\item{rate}{A numeric vector of rates for each interval when using piecewise Poisson distribution.
Length must equal length of a.time. All values must be non-negative. Default is NULL.}

\item{continuous}{A logical value for piecewise Poisson distribution. If TRUE, uses continuous
Poisson process; if FALSE, uses discrete intervals. Default is FALSE.}

\item{e.time}{A named list where each element corresponds to a group, containing time points
defining the survival time intervals. Last element must be Inf.}

\item{e.hazard}{A named list where each element corresponds to a group, containing hazard rates
for survival time. All values must be positive.}

\item{d.time}{A named list where each element corresponds to a group, containing time points
defining the dropout time intervals. Last element must be Inf. Can be NULL if no dropout
is assumed. Default is NULL.}

\item{d.hazard}{A named list where each element corresponds to a group, containing hazard rates
for dropout time. All values must be positive. Can be NULL if no dropout is assumed.
Default is NULL.}

\item{seed}{A positive integer for random seed setting. Default is NULL.}
}
\value{
A tibble containing the simulated clinical trial data with the following columns:
\describe{
\item{simID}{Simulation iteration ID (1 to nsim)}
\item{patientID}{Patient ID within each simulation (1 to total sample size)}
\item{group}{Group indicator (control, treatment, etc.)}
\item{accrual.time}{Patient accrual time from study start}
\item{survival.time}{Survival time from patient entry}
\item{dropout.time}{Time to dropout from patient entry}
\item{tte}{Time-to-event (minimum of survival time and dropout time)}
\item{total}{Total time from study start (accrual time + time-to-event)}
\item{dropout}{Dropout indicator (1 = dropout occurred, 0 = event occurred)}
}
}
\description{
This function generates simulation datasets for clinical trials with multiple treatment
groups using group-wise operations. It supports flexible accrual patterns (piecewise
uniform or piecewise Poisson) and optional dropout modeling.
}
\details{
This function uses group-wise operations to ensure statistical correctness. Each simulation
generates independent random numbers, avoiding issues with cumulative effects that can
occur with batch generation approaches.

The function supports:
\describe{
\item{Multiple Groups}{Any number of treatment groups can be specified.}
\item{Flexible Accrual}{Choose between piecewise uniform or piecewise Poisson distributions.}
\item{Optional Dropout}{Dropout can be disabled by setting d.time and d.hazard to NULL.}
\item{Statistical Correctness}{Each simulation generates independent samples.}
}
}
\examples{
library(dplyr)

# Example 1: Two-group trial with piecewise uniform accrual
trial1 <- simTrialData(
  nsim = 100,
  n = list(control = 250, treatment = 250),
  a.dist = 'pieceunif',
  a.time = c(0, 5, 10, 15, 20, 25),
  proportion = c(0.05, 0.1, 0.15, 0.3, 0.4),
  e.time = list(control = c(0, Inf), treatment = c(0, Inf)),
  e.hazard = list(control = log(2) / 4.3, treatment = log(2) / 5.811),
  d.time = list(control = c(0, Inf), treatment = c(0, Inf)),
  d.hazard = list(control = -log(1 - 0.1) / 12, treatment = -log(1 - 0.1) / 12),
  seed = 1
)

# Example 2: Three-group trial without dropout
trial2 <- simTrialData(
  nsim = 50,
  n = list(control = 100, treatment1 = 100, treatment2 = 100),
  a.dist = 'pieceunif',
  a.time = c(0, 12, 24),
  intensity = c(12.5, 12.5),
  e.time = list(
    control = c(0, Inf),
    treatment1 = c(0, Inf),
    treatment2 = c(0, Inf)
  ),
  e.hazard = list(
    control = 0.08,
    treatment1 = 0.06,
    treatment2 = 0.05
  ),
  d.time = NULL,  # No dropout
  d.hazard = NULL
)

# Example 3: Single-group trial with Poisson accrual
trial3 <- simTrialData(
  nsim = 100,
  n = list(treatment = 200),
  a.dist = 'piecepois',
  a.time = c(0, 6, 12, 18),
  rate = c(5, 10, 8, 2),
  continuous = TRUE,
  e.time = list(treatment = c(0, Inf)),
  e.hazard = list(treatment = 0.1),
  seed = 123
)

}
\seealso{
\code{\link{rpieceunif}} for piecewise uniform distribution,
\code{\link{rpieceexp}} for piecewise exponential distribution,
\code{\link{rpiecepois}} for piecewise Poisson distribution
}
