% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lrtest.R
\name{lrtest}
\alias{lrtest}
\title{Calculate log-rank test statistic for a two-arm parallel group trial}
\usage{
lrtest(
  time,
  event,
  group,
  control,
  side,
  handling_tie = TRUE,
  is_sorted = FALSE
)
}
\arguments{
\item{time}{A numeric vector representing the event times for all subjects.}

\item{event}{A numeric vector representing the event indicator for all subjects
(1 = event occurred, 0 = censored).}

\item{group}{A numeric vector representing the group indicator for all subjects.}

\item{control}{A numeric value indicating which value in \code{group} represents
the control group.}

\item{side}{A numeric value indicating the type of test: 1 for one-sided test,
2 for two-sided test (returns chi-square statistic).}

\item{handling_tie}{A logical value indicating whether to handle tied observations.
Set to FALSE for simulation data with continuous distributions (faster). Default is TRUE.}

\item{is_sorted}{A logical value indicating whether the data is already sorted by time.
Set to TRUE for pre-sorted data to skip sorting operations (faster). Default is FALSE.}
}
\value{
A numeric value of the log-rank test statistic. For \code{side = 1},
returns the standardized log-rank statistic (Z-score). For \code{side = 2},
returns the chi-square statistic (Z^2).
}
\description{
This function calculates the log-rank test statistic for comparing survival curves
between two groups. It can return either one-sided or two-sided test statistics.
The implementation is optimized for performance compared to standard survival
analysis functions, with optional tie handling for maximum speed.
}
\details{
The log-rank test is a non-parametric test used to compare the survival
distributions of two groups. This implementation uses an optimized algorithm
that is significantly more efficient than the standard \code{\link[survival]{survdiff}}
function while producing equivalent results.

When \code{handling_tie = FALSE}, the function assumes no tied event times
(suitable for simulation data from continuous distributions) and uses a faster
algorithm that avoids ranking and tabulation operations.

When \code{is_sorted = TRUE}, the function assumes the data is already sorted
by time and skips sorting operations for additional speed improvement.

The function computes the test statistic using the standard log-rank formula:
\deqn{Z = \frac{O_1 - E_1}{\sqrt{V_1}}}
where \eqn{O_1} is the observed number of events in group 1, \eqn{E_1} is the
expected number of events in group 1, and \eqn{V_1} is the variance.
}
\examples{
library(survival)

# One-sided log-rank test with tie handling
z_stat <- lrtest(ovarian$futime, ovarian$fustat, ovarian$rx, 2, 1)
cat("One-sided Z statistic:", z_stat, "\n")

# Two-sided log-rank test without tie handling (faster for simulation data)
set.seed(123)
n <- 1000
group_sim <- rep(c(1, 2), each = n/2)
time_sim <- c(rexp(n/2, 0.1), rexp(n/2, 0.15))
event_sim <- rep(1, n)
chisq_stat <- lrtest(time_sim, event_sim, group_sim, 1, 2, handling_tie = FALSE)
cat("Chi-square statistic:", chisq_stat, "\n")

# Ultra-fast version for pre-sorted simulation data
ord <- order(time_sim)
chisq_stat_fast <- lrtest(time_sim[ord], event_sim[ord], group_sim[ord], 1, 2,
                         handling_tie = FALSE, is_sorted = TRUE)
cat("Ultra-fast result:", chisq_stat_fast, "\n")

}
\seealso{
\code{\link[survival]{survdiff}} for the standard implementation,
\code{\link{esthr}} for hazard ratio estimation
}
