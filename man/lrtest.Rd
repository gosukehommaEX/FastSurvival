% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lrtest.R
\name{lrtest}
\alias{lrtest}
\title{Calculate log-rank test statistic for a two-arm parallel group trial}
\usage{
lrtest(
  time,
  event,
  group,
  control,
  side,
  time_ranks = NULL,
  event_times = NULL
)
}
\arguments{
\item{time}{A numeric vector representing the event times for all subjects.}

\item{event}{A numeric vector representing the event indicator for all subjects
(1 = event occurred, 0 = censored).}

\item{group}{A numeric vector representing the group indicator for all subjects.}

\item{control}{A numeric value indicating which value in \code{group} represents
the control group.}

\item{side}{A numeric value indicating the type of test: 1 for one-sided test,
2 for two-sided test (returns chi-square statistic).}

\item{time_ranks}{A numeric vector of pre-computed ranks for time. If NULL,
ranks will be computed internally. Default is NULL.}

\item{event_times}{A numeric vector of pre-computed unique event times. If NULL,
will be computed internally. Default is NULL.}
}
\value{
A numeric value of the log-rank test statistic. For \code{side = 1},
returns the standardized log-rank statistic (Z-score). For \code{side = 2},
returns the chi-square statistic (Z^2).
}
\description{
This function calculates the log-rank test statistic for comparing survival curves
between two groups. It can return either one-sided or two-sided test statistics.
The implementation is optimized for performance compared to standard survival
analysis functions.
}
\details{
The log-rank test is a non-parametric test used to compare the survival
distributions of two groups. This implementation uses an optimized algorithm
that is significantly more efficient than the standard \code{\link[survival]{survdiff}}
function while producing equivalent results.

The function converts event times to ranks to handle tied observations and
computes the test statistic using the standard log-rank formula:
\deqn{Z = \frac{O_1 - E_1}{\sqrt{V_1}}}
where \eqn{O_1} is the observed number of events in group 1, \eqn{E_1} is the
expected number of events in group 1, and \eqn{V_1} is the variance.
}
\examples{
library(survival)

# One-sided log-rank test
z_stat <- lrtest(ovarian$futime, ovarian$fustat, ovarian$rx, 2, 1)
cat("One-sided Z statistic:", z_stat, "\n")

# Two-sided log-rank test (chi-square)
chisq_stat <- lrtest(ovarian$futime, ovarian$fustat, ovarian$rx, 2, 2)
cat("Chi-square statistic:", chisq_stat, "\n")

# Compare with survdiff
survdiff_result <- survdiff(Surv(futime, fustat) ~ rx, data = ovarian)
cat("survdiff chi-square:", survdiff_result$chisq, "\n")
cat("lrtest chi-square:", chisq_stat, "\n")

# Performance comparison
\dontrun{
library(microbenchmark)
microbenchmark(
  survdiff = survdiff(Surv(futime, fustat) ~ rx, data = ovarian),
  lrtest = lrtest(ovarian$futime, ovarian$fustat, ovarian$rx, 2, 2),
  times = 100
)
}

}
\references{
Mantel, N. (1966). Evaluation of survival data and two new rank order statistics
arising in its consideration. Cancer Chemotherapy Reports, 50(3), 163-270.

Peto, R., & Peto, J. (1972). Asymptotically efficient rank invariant test procedures.
Journal of the Royal Statistical Society, 135(2), 185-207.
}
\seealso{
\code{\link[survival]{survdiff}} for the standard implementation,
\code{\link{esthr}} for hazard ratio estimation
}
