% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subgroupSummary.R
\name{subgroupSummary}
\alias{subgroupSummary}
\title{Subgroup statistical analysis summary for clinical trial data}
\usage{
subgroupSummary(data, control = 1, hr_est_method = "Cox")
}
\arguments{
\item{data}{A data.table containing analysis data generated by \code{\link{analysisData}}.
Must contain columns: simID, analysis, group, subgroup, tte, event.}

\item{control}{A numeric value indicating which value in \code{group} represents
the control group. Default is 1.}

\item{hr_est_method}{A character string specifying the hazard ratio estimation method.
Must be one of "PY", "Pike", "Peto", "LR", or "Cox". Default is "Cox".}
}
\value{
A data.table containing subgroup analysis results with the following columns:
\describe{
\item{simID}{Simulation iteration ID}
\item{analysis}{Analysis number}
\item{subgroup}{Subgroup indicator}
\item{hazard_ratio}{Estimated hazard ratio}
\item{hr_method}{Method used for hazard ratio estimation}
\item{n_total}{Total number of patients in subgroup}
\item{n_control}{Number of patients in control group within subgroup}
\item{n_treatment}{Number of patients in treatment group within subgroup}
\item{events_total}{Total number of events in subgroup}
\item{events_control}{Number of events in control group within subgroup}
\item{events_treatment}{Number of events in treatment group within subgroup}
}
}
\description{
This function performs subgroup statistical analysis on clinical trial data
generated by \code{\link{analysisData}}. It calculates hazard ratios, patient counts,
and event counts for each subgroup using data.table for maximum performance.
}
\details{
This function provides subgroup summary of clinical trial results by:

\describe{
\item{Hazard Ratio Estimation}{
Calculates hazard ratios using \code{\link{esthr}} for each subgroup
using the specified method.
}
\item{Patient and Event Counts}{
Summarizes patient numbers and event numbers by group for each subgroup.
}
}

All calculations are performed using data.table for maximum efficiency and are
stratified by simulation ID, analysis number, and subgroup.
}
\examples{
library(data.table)

# Generate trial data with subgroups
trial_data <- simTrial(
  nsim = 50,
  N = list(
    control = c(A = 50, B = 50),
    treatment = c(A = 50, B = 50)
  ),
  a.time = c(0, 18),
  intensity = 200/18,
  e.time = list(
    control = list(A = c(0, Inf), B = c(0, Inf)),
    treatment = list(A = c(0, Inf), B = c(0, Inf))
  ),
  e.hazard = list(
    control = list(A = 0.08, B = 0.12),
    treatment = list(A = 0.05, B = 0.08)
  ),
  d.time = list(
    control = list(A = c(0, Inf), B = c(0, Inf)),
    treatment = list(A = c(0, Inf), B = c(0, Inf))
  ),
  d.hazard = list(
    control = list(A = 0.01, B = 0.01),
    treatment = list(A = 0.01, B = 0.01)
  ),
  seed = 123
)

# Create analysis datasets
analysis_data <- analysisData(trial_data, E = c(50, 100, 150))

# Generate subgroup summary
subgroup_results <- subgroupSummary(analysis_data, control = 1, hr_est_method = "Cox")

# View results for first simulation, first analysis
print(subgroup_results[simID == 1 & analysis == 1])

# Example with no dropout
trial_data_no_dropout <- simTrial(
  nsim = 50,
  N = list(
    control = c(A = 50, B = 50),
    treatment = c(A = 50, B = 50)
  ),
  a.time = c(0, 18),
  intensity = 200/18,
  e.time = list(
    control = list(A = c(0, Inf), B = c(0, Inf)),
    treatment = list(A = c(0, Inf), B = c(0, Inf))
  ),
  e.hazard = list(
    control = list(A = 0.08, B = 0.12),
    treatment = list(A = 0.05, B = 0.08)
  ),
  d.time = NULL,  # No dropout
  d.hazard = NULL
)

analysis_data_no_dropout <- analysisData(trial_data_no_dropout, E = c(50, 100, 150))
subgroup_results_no_dropout <- subgroupSummary(analysis_data_no_dropout, control = 1)

}
\seealso{
\code{\link{analysisData}} for creating the input analysis datasets,
\code{\link{esthr}} for hazard ratio estimation,
\code{\link{overallSummary}} for overall population analysis
}
