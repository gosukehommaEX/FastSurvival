% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/esthr.R
\name{esthr}
\alias{esthr}
\title{Estimate hazard ratio for a two-arm parallel group trial}
\usage{
esthr(
  time,
  event,
  group,
  control,
  method,
  time_ranks = NULL,
  event_times = NULL
)
}
\arguments{
\item{time}{A numeric vector representing the event times for all subjects.}

\item{event}{A numeric vector representing the event indicator for all subjects
(1 = event occurred, 0 = censored).}

\item{group}{A numeric vector representing the group indicator for all subjects.}

\item{control}{A numeric value indicating which value in \code{group} represents
the control group.}

\item{method}{A character string specifying the estimation method. Must be one of:
\itemize{
\item \code{"PY"}: Person-Year method
\item \code{"Pike"}: Pike's method
\item \code{"Peto"}: Peto's method
\item \code{"LR"}: Log-rank test based method
\item \code{"Cox"}: Cox proportional hazards regression
}}

\item{time_ranks}{A numeric vector of pre-computed ranks for time. If NULL,
ranks will be computed internally. Default is NULL.}

\item{event_times}{A numeric vector of pre-computed unique event times. If NULL,
will be computed internally. Default is NULL.}
}
\value{
A data.frame with two columns:
\itemize{
\item \code{method}: The method used for estimation
\item \code{HR}: The estimated hazard ratio
}
}
\description{
This function estimates the hazard ratio using various established methods.
It provides multiple approaches for hazard ratio estimation, each with different
theoretical foundations and computational characteristics.
}
\details{
This function implements five different methods for hazard ratio estimation:

\describe{
\item{Person-Year (PY)}{
Estimates HR as the ratio of event rates:
\deqn{HR = \frac{d_1/t_1}{d_0/t_0}}
where \eqn{d_i} is the number of events and \eqn{t_i} is the total time at risk in group \eqn{i}.
}
\item{Pike's method}{
Uses the formula: \deqn{HR = \frac{O_1 \times E_0}{O_0 \times E_1}}
where \eqn{O_i} is observed events and \eqn{E_i} is expected events in group \eqn{i}.
}
\item{Peto's method}{
Estimates HR as: \deqn{HR = \exp\left(\frac{O_1 - E_1}{V_1}\right)}
where \eqn{V_1} is the variance of the log-rank statistic.
}
\item{Log-rank based (LR)}{
Uses the log-rank statistic: \deqn{HR = \exp\left(\frac{2Z}{\sqrt{O_1 + O_0}}\right)}
where \eqn{Z} is the standardized log-rank statistic.
}
\item{Cox regression}{
Uses the standard Cox proportional hazards model via \code{\link[survival]{coxph}}.
}
}
}
\examples{
library(survival)

# Compare different methods on ovarian cancer data
methods <- c('PY', 'Pike', 'Peto', 'LR', 'Cox')
results <- lapply(methods, function(m) {
  esthr(ovarian$futime, ovarian$fustat, ovarian$rx, 2, m)
})
hr_comparison <- do.call(rbind, results)
print(hr_comparison)

# Using veteran lung cancer data (more events)
veteran_results <- lapply(methods, function(m) {
  esthr(veteran$time, veteran$status, veteran$trt, 1, m)
})
veteran_hr <- do.call(rbind, veteran_results)
print(veteran_hr)

# Performance comparison with Cox regression
\dontrun{
library(microbenchmark)
microbenchmark(
  Cox_standard = coxph(Surv(time, status) ~ trt, data = veteran),
  esthr_Cox = esthr(veteran$time, veteran$status, veteran$trt, 1, 'Cox'),
  esthr_Pike = esthr(veteran$time, veteran$status, veteran$trt, 1, 'Pike'),
  times = 100
)
}

}
\references{
Pike, M. C., et al. (1979). Design and analysis of randomized clinical trials
requiring prolonged observation of each patient. British Journal of Cancer, 40, 1-39.

Peto, R., et al. (1977). Design and analysis of randomized clinical trials
requiring prolonged observation of each patient. British Journal of Cancer, 35, 1-39.

Cox, D. R. (1972). Regression models and life-tables. Journal of the Royal
Statistical Society, 34(2), 187-220.
}
\seealso{
\code{\link[survival]{coxph}} for standard Cox regression,
\code{\link{lrtest}} for log-rank test statistics
}
